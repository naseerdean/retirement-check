<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Structured Retirement Income</title>

<style>
body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Arial,sans-serif;
background:linear-gradient(135deg,#0c1626,#1b2a44);
color:white;
padding:40px 20px;
}

h1{
font-family:Georgia,serif;
font-size:40px;
margin-bottom:10px;
}

.subtitle{
color:#cfd8e3;
margin-bottom:40px;
}

.card{
background:rgba(255,255,255,0.08);
padding:30px;
border-radius:20px;
backdrop-filter:blur(10px);
margin-bottom:30px;
}

button{
background:#d4af37;
color:#0c1626;
padding:14px 28px;
border:none;
border-radius:14px;
font-weight:bold;
font-size:16px;
margin-top:15px;
}

button.secondary{
background:#2b3c58;
color:white;
}

input{
width:100%;
padding:14px;
margin-top:8px;
margin-bottom:18px;
border-radius:12px;
border:none;
font-size:16px;
}

.hidden{display:none;}

.result-box{
padding:20px;
border-radius:16px;
margin-top:20px;
}

.red{background:#5a2a2a;}
.orange{background:#5a4b2a;}
.green{background:#2a5a3a;}

canvas{
background:white;
border-radius:14px;
margin-top:20px;
}

.small{
font-size:12px;
color:#cfd8e3;
margin-top:40px;
}
</style>

<script>
let step=1;

function next(){
document.getElementById("step"+step).classList.add("hidden");
step++;
document.getElementById("step"+step).classList.remove("hidden");
}

function back(){
document.getElementById("step"+step).classList.add("hidden");
step--;
document.getElementById("step"+step).classList.remove("hidden");
}

function runModel(){

let capital=parseFloat(document.getElementById("capital").value)||0;
let income=parseFloat(document.getElementById("income").value)||0;
let pension=parseFloat(document.getElementById("pension").value)||0;
let later=parseFloat(document.getElementById("later").value)||0;
let ret=(parseFloat(document.getElementById("return").value)||5)/100;
let inf=(parseFloat(document.getElementById("inflation").value)||3)/100;
let age=parseInt(document.getElementById("age").value)||67;

let draw1=income-pension;
let draw2=later-pension;

let rate1=(draw1/capital)*100;
let rate2=(draw2/capital)*100;

let balance=capital;
let balances=[];
let years=0;

for(let i=0;i<40;i++){
let withdrawal=(i<8?draw1:draw2)*Math.pow(1+inf,i);
balance=balance*(1+ret)-withdrawal;
if(balance<=0){balance=0;}
balances.push(balance);
if(balance===0){break;}
years++;
}

let depletionAge=age+years;

let box=document.getElementById("output");

if(rate2>8){
box.className="result-box red";
box.innerHTML="<b>Structural mismatch identified.</b><br><br>Later-life withdrawal requirement is materially above common sustainable ranges (3–4%). Under the assumptions entered, capital may deplete around age "+depletionAge+".";
}
else if(rate2>4.5){
box.className="result-box orange";
box.innerHTML="<b>Structural pressure detected.</b><br><br>Later-life withdrawal requirements place pressure on long-term sustainability. Regular review and structural adjustments are advisable.";
}
else{
box.className="result-box green";
box.innerHTML="<b>Structure appears more resilient.</b><br><br>Under current assumptions, withdrawal rates remain within more sustainable ranges. Ongoing review remains important.";
}

drawChart(balances);
next();
}

function drawChart(data){
let c=document.getElementById("chart");
let ctx=c.getContext("2d");
ctx.clearRect(0,0,c.width,c.height);

let max=Math.max(...data);
let w=c.width;
let h=c.height;

ctx.beginPath();
ctx.moveTo(0,h-(data[0]/max*h));

for(let i=1;i<data.length;i++){
ctx.lineTo(i*(w/data.length),h-(data[i]/max*h));
}

ctx.strokeStyle="#d4af37";
ctx.lineWidth=3;
ctx.stroke();
}
</script>
</head>

<body>

<h1>Structured Retirement Income</h1>
<div class="subtitle">Private wealth boutique diagnostic</div>

<!-- STEP 1 -->
<div id="step1">
<div class="card">
<h2>Will Your Retirement Survive Phase Two?</h2>
<p>Most retirement plans assume steady spending.</p>
<p>Few prepare for inflation, longevity, and rising later-life costs.</p>
<p>If withdrawals exceed sustainable returns for prolonged periods, capital erosion accelerates — particularly after income step-changes.</p>
<button onclick="next()">Begin Diagnostic</button>
</div>
</div>

<!-- STEP 2 -->
<div id="step2" class="hidden">
<div class="card">
<h2>Why This Matters</h2>
<p>• Inflation compounds quietly over decades<br>
• Withdrawal rates above 4% can pressure sustainability<br>
• Later-life care costs can materially increase income needs<br>
• Markets do not move in straight lines</p>
<p>This structured diagnostic reveals withdrawal-rate pressure — not market forecasts.</p>
<button onclick="next()">Check My Position</button>
<button class="secondary" onclick="back()">Back</button>
</div>
</div>

<!-- STEP 3 -->
<div id="step3" class="hidden">
<div class="card">
<h2>Step 1 — Your Position</h2>
<label>Total invested capital (£)</label>
<input type="number" id="capital" value="600000">
<label>Current age</label>
<input type="number" id="age" value="67">
<button onclick="next()">Next</button>
<button class="secondary" onclick="back()">Back</button>
</div>
</div>

<!-- STEP 4 -->
<div id="step4" class="hidden">
<div class="card">
<h2>Step 2 — Income Needs</h2>
<label>Required income per year (£)</label>
<input type="number" id="income" value="45000">
<label>Guaranteed income (State Pension / annuity) (£)</label>
<input type="number" id="pension" value="11500">
<p>We calculate portfolio draw required after guaranteed income.</p>
<button onclick="next()">Next</button>
<button class="secondary" onclick="back()">Back</button>
</div>
</div>

<!-- STEP 5 -->
<div id="step5" class="hidden">
<div class="card">
<h2>Step 3 — Phase Two (later life)</h2>
<label>Later-life income requirement (£)</label>
<input type="number" id="later" value="80000">
<p>Later-life care or support can significantly increase annual costs. We model this separately to test structural resilience.</p>
<button onclick="next()">Next</button>
<button class="secondary" onclick="back()">Back</button>
</div>
</div>

<!-- STEP 6 -->
<div id="step6" class="hidden">
<div class="card">
<h2>Step 4 — Assumptions</h2>
<label>Expected return (%) (default 5%)</label>
<input type="number" id="return" value="5">
<label>Expected inflation (%) (typical 3–4%)</label>
<input type="number" id="inflation" value="3">
<p>This uses a simple net return assumption and inflates withdrawals annually. Designed to reveal structural withdrawal-rate pressure rather than predict markets.</p>
<button onclick="runModel()">View Structural Diagnosis</button>
<button class="secondary" onclick="back()">Back</button>
</div>
</div>

<!-- STEP 7 -->
<div id="step7" class="hidden">
<div class="card">
<h2>Step 5 — Structural Diagnosis</h2>
<div id="output"></div>
<canvas id="chart" width="320" height="200"></canvas>
<p><b>What structured planning changes:</b><br>
Build an income floor. Match predictable liabilities with lower-volatility assets (in a ~5% yield environment). Retain a growth reserve for longevity.</p>
<button>Request Confidential Review</button>
</div>
</div>

<div class="small">
Illustrative modelling only. Not personal financial advice. Investment values can fall as well as rise.
</div>

</body>
</html>
